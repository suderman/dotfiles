#!/bin/bash
# run with sudo to update desktop launchers for wayland

desktops=$(cat << END
  /usr/share/applications/1password.desktop
  /usr/share/applications/discord.desktop
  /usr/share/applications/io.element.Element.desktop
  /usr/share/applications/obsidian.desktop
  /usr/share/applications/plexamp.desktop
  /usr/share/applications/spotify.desktop
  /opt/standardnotes-bin/standard-notes.desktop
END
)

for desktop in $desktops; do
  if [ -e $desktop ]; then
    if [ -z "$(grep ozone-platform=wayland $desktop)" ]; then
      echo "$(awk '/^Exec=/{$0=$0 " --enable-features=UseOzonePlatform --ozone-platform=wayland"}1' $desktop)" > $desktop
    fi
  fi
done
